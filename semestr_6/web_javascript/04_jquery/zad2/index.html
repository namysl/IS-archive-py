<!DOCTYPE html>
<html lang="pl">
<head>
	<meta charset="UTF-8">
	<title>JSON</title>
	<link rel="stylesheet" href="style_form.css">

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
</head>
<body>

	<div id="film">
		<label for="tytul">Tytuł:</label><br>
		<input type="text" id="tytul"></input><br>
		<label for="rok">Rok produkcji (niewymagany):</label><br>
		<input type="number" id="rok"></input>
		<br>
		
		<button id="sprawdz" type="button">Sprawdź</button>
	
	</div>

    <p><div id="basic_i"></div></p>
	<p><div id="crew_i"></div></p>
	<p><div id="plot_i"></div></p>
	<p><div id="poster_i"></div></p>
	
    <script>
		$(document).ready(function(){
			$("#sprawdz").click(function(){
				let api_link = '';

				var tytul = document.getElementById('tytul').value;
				var tytul_plus = tytul.replace(" ", "+");
				console.log(tytul_plus);
				
				api_link += 'http://www.omdbapi.com/?t=';
				api_link += tytul_plus;
				
				var rok = document.getElementById('rok').value;
				
				if (rok){
					console.log(rok);
					api_link += '&y=';
					api_link += rok;
				}
				
				api_link += '&apikey=d6d27727';
				
				$.getJSON(api_link, function(data) {
					let odp = `${data.Response}`;
					
					if(odp == "False"){
						let error_info = "<h2>Nie znaleziono takiego filmu lub serialu.</h2>";
						$("#basic_i").html(error_info);
						document.getElementById('crew_i').innerHTML = "";
						document.getElementById('plot_i').innerHTML = "";
						document.getElementById('poster_i').innerHTML = "";
					}
					else{
						let basic_info = "<b>Podstawowe informacje:</b><br>";					
						basic_info += `Tytuł: ${data.Title}<br>
										Premiera: ${data.Released}<br>
										Kraj: ${data.Country}<br>
										Gatunek: ${data.Genre}<br>
										Czas trwania: ${data.Runtime}<br>`
						$("#basic_i").html(basic_info);
						
						let crew_info = "<b>Ekipa filmowa:</b><br>";
						crew_info += `Reżyseria: ${data.Director}<br>
										Scenariusz: ${data.Writer}<br>
										Występują: ${data.Actors}<br>`
						$("#crew_i").html(crew_info);
						
						let plot_info = "<b>Opis fabuły:</b><br>";
						plot_info += `${data.Plot}`
						$("#plot_i").html(plot_info);
						
						let poster_info = `<img src="${data.Poster}">`
						$("#poster_i").html(poster_info);
					}
				});
			})
		});
    </script>

</body>
</html>
